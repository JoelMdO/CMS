"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[360],{1154:(e,t,a)=>{a.d(t,{A:()=>r});var n=a(4752),s=a.n(n);let r=function(e){let t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";switch(e){case"link":t="Link inserted";break;case"saved":t="Article sent";break;case"auth":t="Welcome!! \n".concat(a);break;default:t="Image uploaded"}s().mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.onmouseenter=s().stopTimer,e.onmouseleave=s().resumeTimer}}).fire({icon:"success",title:"".concat(t,"  successfully")})}},5360:(e,t,a)=>{a.r(t),a.d(t,{default:()=>g});var n=a(5155),s=a(2115),r=a(7496);let l=async e=>new Promise((t,a)=>{let n=window.indexedDB.open("imageStore",1);return window.indexedDB||console.error("IndexedDB is not supported by your browser."),n.onupgradeneeded=e=>{e.target.result.createObjectStore("images",{keyPath:"id"})},n.onsuccess=n=>{let s=n.target.result,r=new FileReader,l=!1;r.onload=n=>{var r;let o=s.transaction("images","readwrite"),i=o.objectStore("images"),d=null===(r=n.target)||void 0===r?void 0:r.result;if("string"==typeof d){let t=atob(d.split(",")[1]),a=[];for(let e=0;e<t.length;e++)a.push(t.charCodeAt(e));let n=new File([new Blob([new Uint8Array(a)],{type:e.type})],e.name,{type:e.type});i.put({id:e.name,data:n}),l=!0}else a({status:205,message:"Error reading file data"});o.oncomplete=()=>{l?t({status:200,message:"Image saved to the IndexedDB ".concat(e.name)}):a({status:205,message:"Error saving image to the IndexedDB"})},o.onerror=()=>{a({status:205,message:"Error saving image to the IndexedDB"})}},r.readAsDataURL(e)},n.onerror=e=>{a({status:205,message:"Error saving image to the IndexedDB ".concat(e)})},{status:200,message:"Image saved to the IndexedDB"}}),o=async(e,t,a)=>{try{var n;let a=null===(n=e.target.files)||void 0===n?void 0:n[0],s=null==a?void 0:a.name;if(!a||!t)return;let o=await (0,r.A)("clean-image",a);if(200!==o.status)return{status:205,message:"Image not valid"};{let n=new FileReader;return n.onload=async n=>{var r;if(!(null===(r=n.target)||void 0===r?void 0:r.result))return;let o=document.createElement("img");o.src=n.target.result,o.style.justifySelf="center",o.style.maxWidth="35%";let i=new Date,d="".concat(String(i.getDate()).padStart(2,"0"),"-").concat(String(i.getMonth()+1).padStart(2,"0"),"-").concat(i.getFullYear().toString().slice(-2)),c="".concat(d,"-").concat(s);o.setAttribute("id",c);let u=document.createElement("p");u.textContent=c,u.style.justifySelf="center",u.className="text-xs text-gray-500",o.dataset.refId=c,document.body.appendChild(u),document.body.appendChild(o);let g=URL.createObjectURL(a),m=await l(a);if(205===m.status)return m;let p=JSON.parse(sessionStorage.getItem("articleContent")||"[]");p.push({type:"image",imageId:c,fileName:a.name,blobUrl:g}),sessionStorage.setItem("articleContent",JSON.stringify(p)),o.onclick=e=>{let t=window.getSelection(),a=document.createRange();a.selectNode(e.target),null==t||t.removeAllRanges(),null==t||t.addRange(a)},o.oncontextmenu=e=>{e.preventDefault();let t=JSON.parse(sessionStorage.getItem("editorImages")||"[]").filter(e=>e.id!==c);sessionStorage.setItem("editorImages",JSON.stringify(t));let a=document.querySelector("p:contains('".concat(c,"')"));a&&a.remove(),o.remove()};let h=window.getSelection(),f=(null==h?void 0:h.rangeCount)?h.getRangeAt(0):null;if(f){f.deleteContents(),null==f||f.insertNode(o),null==f||f.collapse(!1),null==f||f.setStartAfter(o),null==f||f.insertNode(u),null==f||f.collapse(!1);let e=document.createTextNode("\xa0");f.insertNode(e);let a=new Event("input",{bubbles:!0,cancelable:!0});t.dispatchEvent(a)}else null==t||t.appendChild(o),null==t||t.appendChild(u);e.target.value=""},n.readAsDataURL(a),{status:200,message:"Image uploaded successfully"}}}catch(e){return{status:205,message:e}}};var i=a(4540),d=a(6766),c=a(1154),u=a(2982);let g=e=>{let{editorRefs:t=null,index:a=0}=e,r=(null==t?void 0:t.current)?t.current[a]:null,l=(0,s.useRef)(null),[g,m]=(0,s.useState)(!1),p=(0,i.wA)(),h=()=>{var e;m(!0),null===(e=l.current)||void 0===e||e.click()};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("button",{className:"h-[40px] w-[9em] shadow-md shadow-black ".concat(g?"bg-cream":"bg-blue"," hover:bg-green ").concat(g?"text-black":"text-white"," text-[0.60rem] md:text-lg font-bold rounded text-center flex items-center justify-center md:gap-2 gap-1 mt-4"),onClick:()=>{h()},children:[(0,n.jsx)(d.default,{src:"/upload-outline.png",className:"md:w-6 md:h-6 w-3 h-3 cursor-pointer",width:12,height:12,alt:"uploaded-image"}),"Add Image"]}),(0,n.jsx)("input",{type:"file",ref:l,onChange:e=>{r&&o(e,r,p).then(e=>{m(!1),200===e.status?(0,c.A)("image"):(0,u.A)("image","non200",e.message)}).catch(e=>{m(!1),(0,u.A)("image","error",e)})},accept:"image/*",className:"hidden"})]})}}}]);